## 2026-01-05 - Symlink Traversal Protection
**Vulnerability:** `os.WriteFile` (and similar Go file I/O functions) implicitly follow symbolic links. In the context of writing certificates to a user-controlled directory, this allowed an attacker to create a symlink (e.g., `ca.pem -> /etc/shadow`) and have the application overwrite the target system file when it attempted to "create" the certificate.
**Learning:** Checking for file existence or using standard write functions is insufficient when the parent directory is untrusted or writable by a potential attacker. `os.IsNotExist` checks on removal are crucial to distinguish between "file already gone" (safe) and "cannot remove file" (unsafe state).
**Prevention:** Always explicitly `os.Remove()` a file path before writing to it if the destination directory is potentially user-controlled or shared. Ensure that `os.Remove` errors are handled: ignore `os.ErrNotExist`, but treat other errors (like Permission Denied) as fatal to prevent the write operation from proceeding against a persistent symlink.
